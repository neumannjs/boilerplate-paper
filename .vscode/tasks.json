{
  // See https://go.microsoft.com/fwlink/?LinkId=733558
  // for the documentation about the tasks.json format
  "version": "2.0.0",
  "tasks": [
    {
      "label": "Paper to PDF",
      "type": "shell",
      "command": "${workspaceFolder}\\tasks\\build.ps1",
      "args": [
        "-source",
        "${workspaceFolder}/paper",
        "-defaults",
        "${workspaceFolder}/defaults/paper.yaml"
      ],
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "shared"
      }
    },
    {
      "label": "Paper to DOCX",
      "type": "shell",
      "command": "${workspaceFolder}\\tasks\\build.ps1",
      "args": [
        "-source",
        "${workspaceFolder}/paper",
        "-defaults",
        "${workspaceFolder}/defaults/paper.yaml",
        "-referencedoc",
        "${workspaceFolder}/style/reference.docx",
        "-output",
        "${workspaceFolder}/output/paper.docx",
        "-to",
        "docx"
      ],
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "shared"
      }
    },
    {
      "label": "Poster to PDF",
      "type": "shell",
      "command": "${workspaceFolder}\\tasks\\build.ps1",
      "args": [
        "-source",
        "${workspaceFolder}/poster",
        "-defaults",
        "${workspaceFolder}/defaults/poster.yaml"
      ],
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "shared"
      }
    },
    {
      "label": "Paper to DOCX specific commit",
      "type": "shell",
      "command": "${workspaceFolder}\\tasks\\build.ps1",
      "args": [
        "-source",
        "${workspaceFolder}/paper",
        "-defaults",
        "${workspaceFolder}/defaults/paper.yaml",
        "-referencedoc",
        "${workspaceFolder}/style/reference.docx",
        "-output",
        "${workspaceFolder}/output/paper.docx",
        "-to",
        "docx",
        "-commits",
        "${input:gitCommit}"
      ],
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "shared"
      }
    },
    {
      "label": "Paper track changes DOCX",
      "type": "shell",
      "command": "${workspaceFolder}\\tasks\\compare.ps1",
      "args": [
        "-BaseFileName",
        "${workspaceFolder}/output/paper.docx",
        "-SaveAsFileName",
        "${workspaceFolder}/output/paper-track-changes.docx",
        "-Author",
        "${env:USERNAME}",
        "-commits",
        "${input:gitCommit}"
      ],
      "dependsOn": "Paper to DOCX specific commit",
      "dependsOrder": "sequence",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "shared"
      }
    },
    {
      "label": "Slides to RevealJs",
      "type": "shell",
      "command": "${workspaceFolder}\\tasks\\build.ps1",
      "args": [
        "-source",
        "${workspaceFolder}/slides",
        "-defaults",
        "${workspaceFolder}/defaults/slides.yaml"
      ],
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "shared"
      }
    },
    {
      "label": "Slides to Beamer",
      "type": "shell",
      "command": "${workspaceFolder}\\tasks\\build.ps1",
      "args": [
        "-source",
        "${workspaceFolder}/slides",
        "-defaults",
        "${workspaceFolder}/defaults/slides.yaml",
        "-to",
        "beamer",
        "-output",
        "${workspaceFolder}/output/slides.pdf"
      ],
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "shared"
      }
    },
    ,
    {
      "label": "Slides to PPTX",
      "type": "shell",
      "command": "${workspaceFolder}\\tasks\\build.ps1",
      "args": [
        "-source",
        "${workspaceFolder}/slides",
        "-defaults",
        "${workspaceFolder}/defaults/slides.yaml",
        "-to",
        "pptx",
        "-output",
        "${workspaceFolder}/output/slides.pptx"
      ],
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "shared"
      }
    }
  ],
  "inputs": [
    {
      "type": "promptString",
      "id": "gitCommit",
      "description": "Specify abbreviated commit hash(es)."
    }
  ]
}
